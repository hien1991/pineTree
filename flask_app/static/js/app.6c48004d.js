(function(){"use strict";var e={5936:function(e,t,s){var i=s(9242),n=s(3396);const a={id:"app"},o={class:"top-nav"},l={key:0,class:"guide-modal"},r={class:"guide-modal-content"},c=(0,n._)("h2",null,"Welcome to PineChat!",-1),p=(0,n._)("p",null,"Before you can start using the app, please enter the required API keys in the settings.",-1);function u(e,t,s,i,u,d){const h=(0,n.up)("SideChatBar"),y=(0,n.up)("ChatWindow"),g=(0,n.up)("SettingsModal"),m=(0,n.up)("error-modal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",a,[(0,n._)("nav",o,[(0,n._)("button",{onClick:t[0]||(t[0]=(...e)=>d.toggleDbResults&&d.toggleDbResults(...e))},"Show Datababase Returns"),(0,n._)("button",{onClick:t[1]||(t[1]=(...e)=>d.showSettings&&d.showSettings(...e))},"Settings")]),(0,n.Wm)(h),(0,n.Wm)(y,{dbResultsVisible:u.dbResultsVisible},null,8,["dbResultsVisible"]),u.settingsVisible?((0,n.wg)(),(0,n.j4)(g,{key:0,onClose:d.showSettings,onApiKeysUpdated:d.initializeBackend},null,8,["onClose","onApiKeysUpdated"])):(0,n.kq)("",!0)]),u.showGuideModal?((0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",r,[c,p,(0,n._)("button",{onClick:t[2]||(t[2]=(...e)=>d.hideGuideModalAndShowSettings&&d.hideGuideModalAndShowSettings(...e))},"Go to Settings")])])):(0,n.kq)("",!0),(0,n.Wm)(m,{visible:!!u.errorMessage,message:u.errorMessage,onDismiss:d.dismissError},null,8,["visible","message","onDismiss"])],64)}var d=s(7139);const h=e=>((0,n.dD)("data-v-305e4e78"),e=e(),(0,n.Cn)(),e),y={class:"settings-modal"},g={class:"settings-modal-content"},m=h((()=>(0,n._)("h2",null,"Settings",-1))),v=h((()=>(0,n._)("label",{for:"openai-api-key"},"OpenAI API Key:",-1))),f=h((()=>(0,n._)("label",{for:"pinecone-api-key"},"Pinecone API Key:",-1))),b=h((()=>(0,n._)("label",{for:"pinecone-api-key"},"Pinecone env:",-1))),K={class:"model-toggle-container"},w={class:"switch"},_=["checked"],k=h((()=>(0,n._)("span",{class:"slider round"},null,-1))),A=["disabled"];function C(e,t,s,a,o,l){return(0,n.wg)(),(0,n.iD)("div",y,[(0,n._)("div",g,[m,v,(0,n.wy)((0,n._)("input",{type:"text",id:"openai-api-key","onUpdate:modelValue":t[0]||(t[0]=e=>l.openaiApiKey=e)},null,512),[[i.nr,l.openaiApiKey]]),f,(0,n.wy)((0,n._)("input",{type:"text",id:"pinecone-api-key","onUpdate:modelValue":t[1]||(t[1]=e=>l.pineconeApiKey=e)},null,512),[[i.nr,l.pineconeApiKey]]),b,(0,n.wy)((0,n._)("input",{type:"text",id:"pinecone-env-key","onUpdate:modelValue":t[2]||(t[2]=e=>l.pineconeEnvKey=e)},null,512),[[i.nr,l.pineconeEnvKey]]),(0,n._)("label",K,[(0,n.Uk)("GPT-4: "),(0,n._)("div",w,[(0,n._)("input",{type:"checkbox",id:"model-selection",checked:l.useGpt4Key,onInput:t[3]||(t[3]=(...e)=>l.onUseGpt4KeyChange&&l.onUseGpt4KeyChange(...e)),ref:"modelSelection"},null,40,_),k])]),(0,n._)("button",{onClick:t[4]||(t[4]=(...e)=>l.saveKeys&&l.saveKeys(...e)),disabled:o.submitDisabled,class:"save-button"},"Save",8,A),(0,n._)("button",{onClick:t[5]||(t[5]=t=>e.$emit("close")),class:"close-button"},"Close"),(0,n._)("p",{class:(0,d.C_)(o.displayMessageClass)},(0,d.zw)(o.displayMessage),3)])])}var D=s(65),S=s(4161),M={name:"SettingsModal",data(){return{displayMessage:"",displayMessageClass:"success-message",submitDisabled:!1}},computed:{...(0,D.Se)(["getPineconeApiKey","getPineconeEnvKey","getOpenaiApiKey","getUseGpt4Key"]),pineconeApiKey:{get(){return this.getPineconeApiKey},set(e){this.updatePineconeApiKey(e)}},pineconeEnvKey:{get(){return this.getPineconeEnvKey},set(e){this.updatePineconeEnvKey(e)}},openaiApiKey:{get(){return this.getOpenaiApiKey},set(e){this.updateOpenaiApiKey(e)}},useGpt4Key:{get(){return this.getUseGpt4Key},set(e){this.updateUseGpt4Key(e)}}},emits:["close","api-keys-updated"],methods:{...(0,D.nv)(["updatePineconeApiKey","updatePineconeEnvKey","updateOpenaiApiKey","updateUseGpt4Key"]),saveKeys(){this.$emit("api-keys-updated"),this.displayMessageClass="success-message",this.displayMessage="API keys saved successfully!",setTimeout((()=>{this.displayMessage="",this.$emit("close")}),1500)},onUseGpt4KeyChange(e){e.target.checked?(this.submitDisabled=!0,this.displayMessageClass="success-message",this.displayMessage="Checking GPT-4 availability...",this.checkGpt4Access().then((e=>{e?(this.updateUseGpt4Key(!0),this.displayMessage="GPT-4 check confirmed."):(this.$refs.modelSelection.checked=!1,this.displayMessageClass="error-message",this.displayMessage="We're sorry, but it seems you don't have GPT-4 access.")})).catch((e=>{console.error(e),this.displayMessage="An error occurred while checking GPT-4 access."})).finally((()=>{this.submitDisabled=!1}))):(this.updateUseGpt4Key(!1),this.displayMessage="")},async checkGpt4Access(){const e=this.openaiApiKey,t="gpt-4";return S.Z.get(`https://api.openai.com/v1/models/${t}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}).then((e=>!(200!==e.status||!e.data||e.data.id!==t))).catch((e=>(console.error(e),!1)))}}},G=s(89);const I=(0,G.Z)(M,[["render",C],["__scopeId","data-v-305e4e78"]]);var T=I;const x=e=>((0,n.dD)("data-v-5e4d2114"),e=e(),(0,n.Cn)(),e),P={class:"chat-container"},R=x((()=>(0,n._)("div",{class:"chat-header"},[(0,n._)("h1",null,"PineChat")],-1))),U={class:"chat-window"},E={class:"chat-messages",ref:"chatMessages"},O=x((()=>(0,n._)("div",{class:"spacer"},null,-1))),$={class:"message-bubble"},z={class:"chat-input"};function V(e,t,s,a,o,l){const r=(0,n.up)("TypingLoader"),c=(0,n.up)("UploadButton"),p=(0,n.up)("DbResults");return(0,n.wg)(),(0,n.iD)("div",P,[R,(0,n._)("div",U,[(0,n._)("div",E,[O,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.messages.slice().reverse(),((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:(0,d.C_)(["message",e.type])},[(0,n._)("div",$,(0,d.zw)(e.text),1),o.isTyping&&0===t?((0,n.wg)(),(0,n.j4)(r,{key:0})):(0,n.kq)("",!0)],2)))),128))],512),(0,n._)("button",{class:"scroll-down",onClick:t[0]||(t[0]=(...e)=>l.scrollToBottom&&l.scrollToBottom(...e))},"â†“")]),(0,n._)("div",z,[(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.inputText=e),onKeydown:[t[2]||(t[2]=(0,i.D2)((0,i.iM)(((...e)=>l.submitMessage&&l.submitMessage(...e)),["exact","prevent"]),["enter"])),t[3]||(t[3]=(0,i.D2)((0,i.iM)(((...e)=>l.handleKeyDown&&l.handleKeyDown(...e)),["shift","exact"]),["enter"]))],onInput:t[4]||(t[4]=(...e)=>l.resizeInput&&l.resizeInput(...e)),style:{resize:"none",overflow:"hidden"},class:"chat-input-field",placeholder:"Send a message."},null,544),[[i.nr,o.inputText]]),(0,n._)("button",{onClick:t[5]||(t[5]=(...e)=>l.submitMessage&&l.submitMessage(...e))},"Send"),(0,n.Wm)(c)]),(0,n._)("div",{class:"db-results-wrapper",style:(0,d.j5)({display:s.dbResultsVisible?"block":"none"})},[s.dbResultsVisible?((0,n.wg)(),(0,n.j4)(p,{key:0,results:o.searchResults,searchQueryDisplay:o.searchQueryDisplay},null,8,["results","searchQueryDisplay"])):(0,n.kq)("",!0)],4)])}s(7658);const B=e=>((0,n.dD)("data-v-4acc7736"),e=e(),(0,n.Cn)(),e),Q={class:"database-results"},Z={key:0,class:"search-query-display"},j=B((()=>(0,n._)("strong",null,"Database Query:",-1))),q={class:"search-controls"},F={class:"results-list"},W=["onClick"],H={class:"timestamp"},L={class:"source"},Y={class:"result-content"},J=B((()=>(0,n._)("div",{class:"pagination"},null,-1)));function N(e,t,s,a,o,l){return(0,n.wg)(),(0,n.iD)("div",Q,[s.searchQueryDisplay?((0,n.wg)(),(0,n.iD)("div",Z,[j,(0,n.Uk)(' "'+(0,d.zw)(s.searchQueryDisplay)+'" ',1)])):(0,n.kq)("",!0),(0,n._)("div",q,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>l.filterResults&&l.filterResults(...e)),placeholder:"Search..."},null,544),[[i.nr,o.searchQuery]])]),(0,n._)("div",F,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.filteredResults,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:"result-card"},[(0,n._)("div",{class:"result-header",onClick:e=>l.toggleCollapse(t)},[(0,n._)("h2",null,(0,d.zw)(e.title),1),(0,n._)("span",H,(0,d.zw)(e.timestamp),1),(0,n._)("span",L,(0,d.zw)(e.source),1)],8,W),(0,n.wy)((0,n._)("div",Y,[(0,n._)("p",null,(0,d.zw)(e.text),1)],512),[[i.F8,!e.collapsed]])])))),128))]),J])}var X={name:"DbResults",props:{results:{type:Array,default:()=>[]},searchQueryDisplay:{type:String,default:""}},data(){return{searchQuery:"",filteredResults:[]}},watch:{results:{immediate:!0,handler(){this.filteredResults=this.results.map((e=>({...e,collapsed:!1})))}}},methods:{toggleCollapse(e){this.filteredResults[e].collapsed=!this.filteredResults[e].collapsed},filterResults(){const e=this.searchQuery.toLowerCase();this.filteredResults=this.results.filter((t=>t.title.toLowerCase().includes(e)||t.text&&t.text.toLowerCase().includes(e)))}}};const ee=(0,G.Z)(X,[["render",N],["__scopeId","data-v-4acc7736"]]);var te=ee,se=s.p+"img/upload-icon.5db7b317.png";const ie=e=>((0,n.dD)("data-v-4661d07f"),e=e(),(0,n.Cn)(),e),ne={class:"upload-wrapper"},ae=ie((()=>(0,n._)("img",{src:se,alt:"Uploads Icon"},null,-1))),oe=[ae];function le(e,t,s,i,a,o){return(0,n.wg)(),(0,n.iD)("div",ne,[(0,n._)("input",{type:"file",ref:"fileInput",onChange:t[0]||(t[0]=(...e)=>o.uploadFile&&o.uploadFile(...e)),style:{display:"none"}},null,544),(0,n._)("button",{class:"upload-button",onClick:t[1]||(t[1]=(...e)=>o.openFileChooser&&o.openFileChooser(...e))},oe)])}var re={name:"UploadButton",methods:{openFileChooser(){this.$refs.fileInput.click()},async uploadFile(){const e=new FormData;e.append("file",this.$refs.fileInput.files[0]);try{const t=await S.Z.post(`${this.$apiUrl}/upload`,e,{headers:{"Content-Type":"multipart/form-data"}});console.log(t.data)}catch(t){console.error("Error uploading file:",t)}}}};const ce=(0,G.Z)(re,[["render",le],["__scopeId","data-v-4661d07f"]]);var pe=ce;const ue=e=>((0,n.dD)("data-v-2e3824f7"),e=e(),(0,n.Cn)(),e),de={class:"typing-indicator"},he=ue((()=>(0,n._)("span",{class:"dot"},null,-1))),ye=ue((()=>(0,n._)("span",{class:"dot"},null,-1))),ge=ue((()=>(0,n._)("span",{class:"dot"},null,-1))),me=[he,ye,ge];function ve(e,t,s,i,a,o){return(0,n.wg)(),(0,n.iD)("div",de,me)}var fe={name:"TypingLoader"};const be=(0,G.Z)(fe,[["render",ve],["__scopeId","data-v-2e3824f7"]]);var Ke=be,we={name:"ChatWindow",components:{DbResults:te,UploadButton:pe,TypingLoader:Ke},data(){return{inputText:"",messages:[],isTyping:!1,searchResults:[],searchQueryDisplay:""}},props:{dbResultsVisible:{type:Boolean,default:!1}},methods:{scrollToBottom(){this.$nextTick((()=>{let e=this.$refs.chatMessages.scrollHeight;window.scrollTo(0,e)}))},async submitMessage(){if(this.inputText.trim()){this.messages.push({type:"user",text:this.inputText}),this.isTyping=!0;try{const e=await S.Z.post(`${this.$apiUrl}/chat`,{input_text:this.inputText});if("error"===e.data.status)this.messages.push({type:"error",text:e.data.message});else{const t=e.data.response;this.searchResults=e.data.search_results,this.searchQueryDisplay=e.data.db_query;const s=t;this.messages.push({type:"bot",text:s})}this.isTyping=!1}catch(e){console.error("Error while communicating with chatbot:",e),this.messages.push({type:"error",text:"Error while communicating with chatbot"}),this.isTyping=!1}this.inputText=""}},handleKeyDown(e){if("Enter"===e.key&&e.shiftKey){e.preventDefault();const t=e.target,s=t.selectionStart;t.setRangeText("\n",s,s,"end"),t.setSelectionRange(s+1,s+1),this.inputText=t.value,this.resizeInput(e)}},resizeInput(e){const t=e.target;t.style.height="auto";const s=100,i=35;let n=t.scrollHeight<=51?i:Math.min(t.scrollHeight,s);t.style.height=`${n}px`,t.style.overflowY=n===s?"scroll":"hidden"}}};const _e=(0,G.Z)(we,[["render",V],["__scopeId","data-v-5e4d2114"]]);var ke=_e;const Ae={class:"sidechatbar"};function Ce(e,t,s,i,a,o){return(0,n.wg)(),(0,n.iD)("div",Ae)}var De={name:"SideChatBar",data(){return{}},methods:{}};const Se=(0,G.Z)(De,[["render",Ce],["__scopeId","data-v-3c46d146"]]);var Me=Se;const Ge={key:0,class:"error-modal"},Ie={class:"error-modal-content"},Te=(0,n._)("h3",null,"Error",-1);function xe(e,t,s,i,a,o){return s.visible?((0,n.wg)(),(0,n.iD)("div",Ge,[(0,n._)("div",Ie,[Te,(0,n._)("p",null,(0,d.zw)(s.message),1),(0,n._)("button",{onClick:t[0]||(t[0]=t=>e.$emit("dismiss"))},"OK")])])):(0,n.kq)("",!0)}var Pe={props:{message:{type:String,default:""},visible:{type:Boolean,default:!1}}};const Re=(0,G.Z)(Pe,[["render",xe]]);var Ue=Re,Ee={name:"App",components:{ChatWindow:ke,SideChatBar:Me,SettingsModal:T,ErrorModal:Ue},data(){return{settingsVisible:!1,showGuideModal:!1,dbResultsVisible:!1,errorMessage:""}},methods:{showSettings(){this.settingsVisible=!this.settingsVisible},toggleDbResults(){this.dbResultsVisible=!this.dbResultsVisible},hideGuideModalAndShowSettings(){this.showGuideModal=!1,this.showSettings()},dismissError(){this.errorMessage=""},async initializeBackend(){const e=localStorage.getItem("openaiApiKey"),t=localStorage.getItem("pineconeApiKey"),s=localStorage.getItem("pineconeEnvKey"),i="true"===localStorage.getItem("useGpt4Key");if(e&&t&&s)try{const n=await S.Z.post(`${this.$apiUrl}/initialize`,{openaiApiKey:e,pineconeApiKey:t,pineconeEnvKey:s,useGpt4Key:i});"error"===n.data.status&&this.$emit("error",n.data.message)}catch(n){const e=n.response&&n.response.data&&n.response.data.message;this.errorMessage=e?`An error occurred while initializing the backend: ${e}`:"An error occurred while initializing the backend: "+n}}},mounted(){this.initializeBackend();const e=localStorage.getItem("openaiApiKey"),t=localStorage.getItem("pineconeApiKey"),s=localStorage.getItem("pineconeEnvKey");e&&t&&s||(this.showGuideModal=!0)}};const Oe=(0,G.Z)(Ee,[["render",u]]);var $e=Oe;const ze={pineconeApiKey:localStorage.getItem("pineconeApiKey")||"",pineconeEnvKey:localStorage.getItem("pineconeEnvKey")||"",openaiApiKey:localStorage.getItem("openaiApiKey")||"",useGpt4Key:"true"===localStorage.getItem("useGpt4Key")||!1};var Ve=(0,D.MT)({state:ze,mutations:{setPineconeApiKey(e,t){e.pineconeApiKey=t},setOpenaiApiKey(e,t){e.openaiApiKey=t},setPineconeEnvKey(e,t){e.pineconeEnvKey=t},setUseGpt4Key(e,t){e.useGpt4Key=t}},actions:{updatePineconeApiKey({commit:e},t){e("setPineconeApiKey",t),localStorage.setItem("pineconeApiKey",t)},updateOpenaiApiKey({commit:e},t){e("setOpenaiApiKey",t),localStorage.setItem("openaiApiKey",t)},updatePineconeEnvKey({commit:e},t){e("setPineconeEnvKey",t),localStorage.setItem("pineconeEnvKey",t)},updateUseGpt4Key({commit:e},t){e("setUseGpt4Key",t),localStorage.setItem("useGpt4Key",t.toString())}},getters:{getPineconeApiKey(e){return e.pineconeApiKey},getOpenaiApiKey(e){return e.openaiApiKey},getPineconeEnvKey(e){return e.pineconeEnvKey},getUseGpt4Key(e){return e.useGpt4Key}}});const Be=!1,Qe=Be?"https://your-production-api-url.com":"http://localhost:5050",Ze=(0,i.ri)($e);Ze.config.globalProperties.$apiUrl=Qe,Ze.use(Ve).mount("#app")}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,i,n,a){if(!i){var o=1/0;for(p=0;p<e.length;p++){i=e[p][0],n=e[p][1],a=e[p][2];for(var l=!0,r=0;r<i.length;r++)(!1&a||o>=a)&&Object.keys(s.O).every((function(e){return s.O[e](i[r])}))?i.splice(r--,1):(l=!1,a<o&&(o=a));if(l){e.splice(p--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var p=e.length;p>0&&e[p-1][2]>a;p--)e[p]=e[p-1];e[p]=[i,n,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p=""}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,a,o=i[0],l=i[1],r=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in l)s.o(l,n)&&(s.m[n]=l[n]);if(r)var p=r(s)}for(t&&t(i);c<o.length;c++)a=o[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(p)},i=self["webpackChunkpinechat"]=self["webpackChunkpinechat"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(5936)}));i=s.O(i)})();
//# sourceMappingURL=app.6c48004d.js.map